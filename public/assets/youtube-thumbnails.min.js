function handleYouTubeThumbnailError(t){const e=JSON.parse(t.getAttribute("data-fallback-urls"));let o=parseInt(t.getAttribute("data-current-index"));o++,o<e.length?(t.setAttribute("data-current-index",o),t.src=e[o]):showYouTubePlaceholder(t)}async function validateYouTubeThumbnail(t){if(t.hasAttribute("data-validated"))return!0;if(t.setAttribute("data-validated","true"),t.naturalWidth&&t.naturalWidth<=120)return console.log(`YouTube thumbnail too small (${t.naturalWidth}x${t.naturalHeight}), trying fallback`),handleYouTubeThumbnailError(t),!1;try{await fetch(t.src,{method:"HEAD",mode:"no-cors"});return t.naturalWidth<=120||t.naturalHeight<=90?(console.log("YouTube thumbnail dimensions too small, trying fallback"),handleYouTubeThumbnailError(t),!1):(console.log(`YouTube thumbnail appears valid (${t.naturalWidth}x${t.naturalHeight})`),!0)}catch(e){return console.log("Could not fetch thumbnail, checking dimensions instead"),!(t.naturalWidth<=120||t.naturalHeight<=90)||(console.log("YouTube thumbnail dimensions too small, trying fallback"),handleYouTubeThumbnailError(t),!1)}}function showYouTubePlaceholder(t){t.src="data:image/svg+xml;base64,"+btoa('\n        <svg xmlns="http://www.w3.org/2000/svg" width="480" height="360" viewBox="0 0 480 360">\n            <rect width="480" height="360" fill="#f0f0f0"/>\n            <rect x="190" y="130" width="100" height="100" rx="50" fill="#ff0000"/>\n            <polygon points="220,155 220,205 250,180" fill="white"/>\n            <text x="240" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#666">\n                Vid√©o YouTube\n            </text>\n        </svg>\n    '),t.alt="Miniature YouTube non disponible",t.removeAttribute("onerror")}async function checkYouTubeThumbnail(t){const e=["maxresdefault","hqdefault","mqdefault","default"];for(const o of e){const e=`https://img.youtube.com/vi/${t}/${o}.jpg`;try{if((await fetch(e,{method:"HEAD"})).ok)return e}catch(t){continue}}return null}document.addEventListener("DOMContentLoaded",function(){const t=document.querySelectorAll(".youtube-thumbnail");console.log("Found YouTube thumbnails:",t.length),t.forEach(function(t){console.log("Processing thumbnail:",t.src),t.complete?(console.log("Image already complete, validating now"),validateYouTubeThumbnail(t)):t.addEventListener("load",function(){console.log("Image loaded, validating:",t.src),validateYouTubeThumbnail(t)}),setTimeout(function(){t.complete&&0!==t.naturalHeight||(console.log("Timeout reached, forcing fallback for:",t.src),handleYouTubeThumbnailError(t))},5e3)})}),window.addEventListener("load",function(){console.log("Window fully loaded, rechecking thumbnails");document.querySelectorAll(".youtube-thumbnail").forEach(function(t){t.complete&&!t.hasAttribute("data-validated")&&(console.log("Found unvalidated complete image:",t.src),validateYouTubeThumbnail(t))})}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".youtube-facade").forEach(function(t){t.addEventListener("click",function(e){e.preventDefault();const o=t.getAttribute("data-video-id");if(!o)return;const n=document.createElement("iframe");n.src="https://www.youtube.com/embed/"+o+"?autoplay=1&rel=0",n.setAttribute("frameborder","0"),n.setAttribute("allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"),n.setAttribute("allowfullscreen",""),n.style.width="100%",n.style.height="100%",n.style.position="absolute",n.style.top="0",n.style.left="0",t.innerHTML="",t.appendChild(n),t.classList.remove("youtube-facade"),t.style.cursor="default"})})});