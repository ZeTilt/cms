class HeroCarousel{constructor(t){this.container=t,this.slides=[],this.currentSlide=0,this.autoAdvanceInterval=null,this.init()}init(){let t=this.container.dataset.slides;if(t)try{const e=document.createElement("textarea");e.innerHTML=t,t=e.value,this.slides=JSON.parse(t)}catch(t){return void console.error("Error parsing slides data:",t)}0!==this.slides.length&&(this.render(),this.bindEvents(),this.startAutoAdvance())}render(){const t=this.container.querySelector(".hero-slides");if(!t)return;let e=this.slides.map((t,e)=>`\n            <div class="hero-slide ${0===e?"active":""}"\n                 data-index="${e}"\n                 style="background-image: url(${t.image})"></div>\n        `).join("");e+=`\n            <button class="hero-nav-btn hero-nav-prev" aria-label="Image précédente">\n                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>\n                </svg>\n            </button>\n            <button class="hero-nav-btn hero-nav-next" aria-label="Image suivante">\n                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>\n                </svg>\n            </button>\n            <div class="hero-dots">\n                ${this.slides.map((t,e)=>`\n                    <button class="hero-dot ${0===e?"active":""}" data-index="${e}"></button>\n                `).join("")}\n            </div>\n        `,t.innerHTML=e}bindEvents(){const t=this.container.querySelector(".hero-nav-prev"),e=this.container.querySelector(".hero-nav-next"),n=this.container.querySelectorAll(".hero-dot");t&&t.addEventListener("click",()=>this.prevSlide()),e&&e.addEventListener("click",()=>this.nextSlide()),n.forEach(t=>{t.addEventListener("click",()=>{const e=parseInt(t.dataset.index);this.goToSlide(e)})}),this.container.addEventListener("mouseenter",()=>this.stopAutoAdvance()),this.container.addEventListener("mouseleave",()=>this.startAutoAdvance());let i=0;this.container.addEventListener("touchstart",t=>{i=t.changedTouches[0].screenX,this.stopAutoAdvance()},{passive:!0}),this.container.addEventListener("touchend",t=>{const e=i-t.changedTouches[0].screenX;Math.abs(e)>50&&(e>0?this.nextSlide():this.prevSlide()),this.startAutoAdvance()},{passive:!0})}showSlide(t){const e=this.container.querySelectorAll(".hero-slide"),n=this.container.querySelectorAll(".hero-dot");e.forEach(t=>t.classList.remove("active")),n.forEach(t=>t.classList.remove("active")),e[t]&&e[t].classList.add("active"),n[t]&&n[t].classList.add("active"),this.currentSlide=t}nextSlide(){const t=(this.currentSlide+1)%this.slides.length;this.showSlide(t)}prevSlide(){const t=(this.currentSlide-1+this.slides.length)%this.slides.length;this.showSlide(t)}goToSlide(t){this.showSlide(t)}startAutoAdvance(){this.autoAdvanceInterval||(this.autoAdvanceInterval=setInterval(()=>this.nextSlide(),5e3))}stopAutoAdvance(){this.autoAdvanceInterval&&(clearInterval(this.autoAdvanceInterval),this.autoAdvanceInterval=null)}}document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".hero-carousel");t&&new HeroCarousel(t)});class PhotoGallery{constructor(){this.lightbox=null,this.currentIndex=0,this.images=[],this.init()}init(){this.createLightbox(),this.bindEvents()}createLightbox(){document.body.insertAdjacentHTML("beforeend",'\n            <div class="lightbox" id="lightbox">\n                <div class="lightbox-content">\n                    <button class="lightbox-close" id="lightbox-close">\n                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                            <line x1="18" y1="6" x2="6" y2="18"></line>\n                            <line x1="6" y1="6" x2="18" y2="18"></line>\n                        </svg>\n                    </button>\n                    <button class="lightbox-nav lightbox-prev" id="lightbox-prev">\n                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                            <polyline points="15,18 9,12 15,6"></polyline>\n                        </svg>\n                    </button>\n                    <button class="lightbox-nav lightbox-next" id="lightbox-next">\n                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                            <polyline points="9,18 15,12 9,6"></polyline>\n                        </svg>\n                    </button>\n                    <img id="lightbox-image" src="" alt="">\n                    <div class="lightbox-info" id="lightbox-info">\n                        <h3 id="lightbox-title"></h3>\n                        <p id="lightbox-description"></p>\n                    </div>\n                    <div class="lightbox-counter" id="lightbox-counter"></div>\n                </div>\n            </div>\n        '),this.lightbox=document.getElementById("lightbox")}bindEvents(){document.addEventListener("click",t=>{const e=t.target.closest(".gallery-item");e&&(t.preventDefault(),this.openLightbox(e))}),document.getElementById("lightbox-close").addEventListener("click",()=>this.closeLightbox()),document.getElementById("lightbox-prev").addEventListener("click",()=>this.previousImage()),document.getElementById("lightbox-next").addEventListener("click",()=>this.nextImage()),document.addEventListener("keydown",t=>{if(this.lightbox.classList.contains("active"))switch(t.key){case"Escape":this.closeLightbox();break;case"ArrowLeft":this.previousImage();break;case"ArrowRight":this.nextImage()}}),this.lightbox.addEventListener("click",t=>{t.target===this.lightbox&&this.closeLightbox()})}openLightbox(t){const e=t.closest(".photo-gallery");this.images=Array.from(e.querySelectorAll(".gallery-item")).map(t=>({src:t.querySelector("img").src,title:t.dataset.title||t.querySelector("img").alt,description:t.dataset.description||""})),this.currentIndex=Array.from(e.querySelectorAll(".gallery-item")).indexOf(t),this.showImage(),this.lightbox.classList.add("active"),document.body.style.overflow="hidden"}closeLightbox(){this.lightbox.classList.remove("active"),document.body.style.overflow=""}previousImage(){this.currentIndex=this.currentIndex>0?this.currentIndex-1:this.images.length-1,this.showImage()}nextImage(){this.currentIndex=this.currentIndex<this.images.length-1?this.currentIndex+1:0,this.showImage()}showImage(){const t=this.images[this.currentIndex];document.getElementById("lightbox-image").src=t.src,document.getElementById("lightbox-title").textContent=t.title,document.getElementById("lightbox-description").textContent=t.description,document.getElementById("lightbox-counter").textContent=`${this.currentIndex+1} / ${this.images.length}`;const e=document.getElementById("lightbox-prev"),n=document.getElementById("lightbox-next");this.images.length<=1?(e.style.display="none",n.style.display="none"):(e.style.display="flex",n.style.display="flex")}}function createGallery(t,e,n={}){const i=document.getElementById(t);if(!i)return;const{size:o="medium",showOverlay:l=!0,columns:s=null}=n;let a="photo-gallery";"small"===o&&(a+=" small"),"large"===o&&(a+=" large");const r=`\n        <div class="${a}" ${s?`style="grid-template-columns: repeat(${s}, 1fr)"`:""}>\n            ${e.map(t=>`\n                <div class="gallery-item" data-title="${t.title||""}" data-description="${t.description||""}">\n                    <img src="${t.src}" alt="${t.alt||t.title||"Image"}">\n                    ${l&&(t.title||t.description)?`\n                        <div class="overlay">\n                            ${t.title?`<h4>${t.title}</h4>`:""}\n                            ${t.description?`<p>${t.description}</p>`:""}\n                        </div>\n                    `:""}\n                </div>\n            `).join("")}\n        </div>\n    `;i.innerHTML=r}function handleYouTubeThumbnailError(t){const e=JSON.parse(t.getAttribute("data-fallback-urls"));let n=parseInt(t.getAttribute("data-current-index"));n++,n<e.length?(t.setAttribute("data-current-index",n),t.src=e[n]):showYouTubePlaceholder(t)}async function validateYouTubeThumbnail(t){if(t.hasAttribute("data-validated"))return!0;if(t.setAttribute("data-validated","true"),t.naturalWidth&&t.naturalWidth<=120)return console.log(`YouTube thumbnail too small (${t.naturalWidth}x${t.naturalHeight}), trying fallback`),handleYouTubeThumbnailError(t),!1;try{await fetch(t.src,{method:"HEAD",mode:"no-cors"});return t.naturalWidth<=120||t.naturalHeight<=90?(console.log("YouTube thumbnail dimensions too small, trying fallback"),handleYouTubeThumbnailError(t),!1):(console.log(`YouTube thumbnail appears valid (${t.naturalWidth}x${t.naturalHeight})`),!0)}catch(e){return console.log("Could not fetch thumbnail, checking dimensions instead"),!(t.naturalWidth<=120||t.naturalHeight<=90)||(console.log("YouTube thumbnail dimensions too small, trying fallback"),handleYouTubeThumbnailError(t),!1)}}function showYouTubePlaceholder(t){t.src="data:image/svg+xml;base64,"+btoa('\n        <svg xmlns="http://www.w3.org/2000/svg" width="480" height="360" viewBox="0 0 480 360">\n            <rect width="480" height="360" fill="#f0f0f0"/>\n            <rect x="190" y="130" width="100" height="100" rx="50" fill="#ff0000"/>\n            <polygon points="220,155 220,205 250,180" fill="white"/>\n            <text x="240" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#666">\n                Vidéo YouTube\n            </text>\n        </svg>\n    '),t.alt="Miniature YouTube non disponible",t.removeAttribute("onerror")}async function checkYouTubeThumbnail(t){const e=["maxresdefault","hqdefault","mqdefault","default"];for(const n of e){const e=`https://img.youtube.com/vi/${t}/${n}.jpg`;try{if((await fetch(e,{method:"HEAD"})).ok)return e}catch(t){continue}}return null}document.addEventListener("DOMContentLoaded",()=>{new PhotoGallery}),document.addEventListener("DOMContentLoaded",function(){const t=document.querySelectorAll(".youtube-thumbnail");console.log("Found YouTube thumbnails:",t.length),t.forEach(function(t){console.log("Processing thumbnail:",t.src),t.complete?(console.log("Image already complete, validating now"),validateYouTubeThumbnail(t)):t.addEventListener("load",function(){console.log("Image loaded, validating:",t.src),validateYouTubeThumbnail(t)}),setTimeout(function(){t.complete&&0!==t.naturalHeight||(console.log("Timeout reached, forcing fallback for:",t.src),handleYouTubeThumbnailError(t))},5e3)})}),window.addEventListener("load",function(){console.log("Window fully loaded, rechecking thumbnails");document.querySelectorAll(".youtube-thumbnail").forEach(function(t){t.complete&&!t.hasAttribute("data-validated")&&(console.log("Found unvalidated complete image:",t.src),validateYouTubeThumbnail(t))})});