class ArticleCarousel{constructor(){this.carousels=[],this.init()}init(){this.processCarouselShortcodes(),this.initializeCarousels()}processCarouselShortcodes(){const e=document.querySelector(".article-content, .article-detail-content, .prose");if(!e)return;const t=/\[carousel\](.*?)\[\/carousel\]/g;let s,n=e.innerHTML,r=0;for(;null!==(s=t.exec(n));){const e=s[1].split(",").map(e=>e.trim()).filter(e=>e);if(e.length>0){const t=this.generateCarouselHtml(e,r);n=n.replace(s[0],t),r++}}e.innerHTML=n}generateCarouselHtml(e,t){const s=e.map((e,t)=>`\n            <div class="carousel-slide ${0===t?"active":""}" data-slide="${t}">\n                <img src="${e}" alt="Image ${t+1}" loading="lazy">\n            </div>\n        `).join(""),n=e.map((e,t)=>`\n            <button class="carousel-dot ${0===t?"active":""}" data-slide="${t}"></button>\n        `).join("");return`\n            <div class="article-carousel" data-carousel-id="${t}">\n                <div class="carousel-container">\n                    ${s}\n                    ${e.length>1?`\n                        <button class="carousel-prev" aria-label="Image précédente">\n                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>\n                            </svg>\n                        </button>\n                        <button class="carousel-next" aria-label="Image suivante">\n                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>\n                            </svg>\n                        </button>\n                        <div class="carousel-indicators">\n                            ${n}\n                        </div>\n                    `:""}\n                </div>\n            </div>\n        `}initializeCarousels(){document.querySelectorAll(".article-carousel, .widget-gallery-carousel").forEach(e=>{this.setupCarousel(e)})}setupCarousel(e){const t=e.querySelectorAll(".carousel-slide"),s=e.querySelectorAll(".carousel-dot"),n=e.querySelector(".carousel-prev"),r=e.querySelector(".carousel-next");let a=0;const l=e=>{t.forEach(e=>e.classList.remove("active")),s.forEach(e=>e.classList.remove("active")),t[e].classList.add("active"),s[e]&&s[e].classList.add("active"),a=e},o=()=>{const e=(a+1)%t.length;l(e)},i=()=>{const e=(a-1+t.length)%t.length;l(e)};n&&n.addEventListener("click",e=>{e.preventDefault(),i()}),r&&r.addEventListener("click",e=>{e.preventDefault(),o()}),s.forEach((e,t)=>{e.addEventListener("click",e=>{e.preventDefault(),l(t)})});let c=0,u=0;const d=e.querySelector(".carousel-container");d.addEventListener("touchstart",e=>{c=e.changedTouches[0].screenX},{passive:!0}),d.addEventListener("touchend",e=>{u=e.changedTouches[0].screenX;const t=c-u;Math.abs(t)>50&&(t>0?o():i())},{passive:!0});let v=!1,h=0;d.addEventListener("mousedown",e=>{v=!0,h=e.clientX,d.style.cursor="grabbing"}),d.addEventListener("mousemove",e=>{v&&e.preventDefault()}),d.addEventListener("mouseup",e=>{if(!v)return;v=!1,d.style.cursor="grab";const t=h-e.clientX;Math.abs(t)>50&&(t>0?o():i())}),d.addEventListener("mouseleave",()=>{v=!1,d.style.cursor="grab"});let p=setInterval(o,5e3);e.addEventListener("mouseenter",()=>clearInterval(p)),e.addEventListener("mouseleave",()=>{p=setInterval(o,5e3)}),e.addEventListener("touchstart",()=>clearInterval(p),{passive:!0}),this.carousels.push({element:e,currentSlide:a,totalSlides:t.length,showSlide:l,nextSlide:o,prevSlide:i})}}document.addEventListener("DOMContentLoaded",()=>{new ArticleCarousel}),window.initializeCarousels=()=>{new ArticleCarousel};